/*!
 * Copyright (c) 2017 Russell Steadman
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
 * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
 * DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
 * OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE
 * OR OTHER DEALINGS IN THE SOFTWARE.
 */
!function(){"use strict";var e,t={o:"object",s:"string",f:"function",b:"boolean",n:"number",r:"regex"},n={},o=function(){var e={angular:typeof angular===t.o&&!!angular,console:!!(typeof console===t.o&&console&&console.log&&console.error&&console.info),alert:typeof alert===t.f&&!!alert,document:typeof document===t.o&&!!document,body:typeof document===t.o&&!!document&&typeof document.body===t.o&&!!document.body,mutation:typeof MutationObserver===t.f&&!!MutationObserver,interval:typeof setInterval===t.f&&typeof clearInterval===t.f&&!!setInterval&&!!clearInterval,window:typeof window===t.o&&!!window,module:"undefined"!=typeof module&&module.exports};for(var o in e){n[o]=e[o]}return n};!function(){var t=[],n=!1,o=!1;e=function(e,i){var r=function(){if(!n){n=!0;for(var e=0;e<t.length;e++){t[e].fn.call(this,t[e].ctx)}t=[]}}.bind(i),s=function(){"complete"===document.readyState&&r()};if("function"!=typeof e){throw new TypeError("callback for docReady(fn) must be a function")}if(n){return void setTimeout(function(){e.bind(i)()},1)}t.push({fn:e,ctx:i}),"complete"===document.readyState?setTimeout(r,1):o||(document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):(document.attachEvent("onreadystatechange",s),window.attachEvent("onload",r)),o=!0)}}();var i=function(e,t,n,o){return"http://teamtofu.github.io/onebang/errors/?error="+e+"&one="+encodeURIComponent(t)+"&two="+encodeURIComponent(n)+"&three="+encodeURIComponent(o)},r=[{regex:/^\_\_.*$/,len:2,id:"__"},{regex:/^b\_.*$/,len:2,id:"b_"},{regex:/^B\_.*$/,len:2,id:"B_"},{regex:/^!.*$/,len:1,id:"!"},{regex:/^\:\:.*$/,len:2,id:"::"},{regex:/^1.*$/,len:1,id:"1"}],s=function(e,t){var n=t.getAttribute("class");n=n?n.split(" "):[];for(var o in e){-1===n.indexOf(e[o])&&n.push(encodeURIComponent(e[o]))}t.setAttribute("class",n.join(" ").trim())},a=function(e,n,o){var i="onebang_isolate",s=o.getAttribute(i)?o.getAttribute(i).split(" "):[],a=typeof o.getAttribute(n+e)===t.s?n+e:null;if(a){s.push(a)}else{for(var u in r){if(a=typeof o.getAttribute(r[u].id+e)===t.s?r[u].id+e:null){s.push(a);break}}}o.removeAttribute(a),o.setAttribute(i,s.join(" "))},u={console:function(e){for(var t in e){o().console&&console.log(e[t])}},class:function(e){s(e,this)},c:"class",hash:function(e){var n=this.getAttribute("href");n=typeof n===t.s?n.split("#"):["",""],n[1]=e[0]?e[0]:"",this.setAttribute("href",n.join("#"))},"#":"hash",icon:function(e){switch(e[0]){case"fa":case"fontawesome":s(["fa","fa-"+e[1],e[2]?"fa-"+e[2]+"x":"",e[3]?"fa-spin":""],this);break;case"ion":case"ionicon":s(["ion","icon","ion-"+e[1]],this);break;case"gly":case"glyph":case"glyphicon":s(["glyphicon","glyphicon-"+e[1]],this);break;case"oi":case"openicon":s(["oi","oi-"+e[1]],this)}},i:"icon",id:function(e){e[0]?this.setAttribute("id",e[0]):this.removeAttribute("id")},exclaim:function(e,n,o,r){if(typeof n===t.o&&n){var a=[];n.default||(n.default="");for(var u in e){-1===a.indexOf(e[u]?n[e[u]]:n.default)&&(e[u]?n[e[u]]?a.push(n[e[u]]):r(i("ai",e[u])):a.push(n.default))}e[0]||a.push(n.default),s(a,this)}},"!":"exclaim",style:function(e,t,n,o){if(!e[0]||!e[1]){return o(i("aj"))}this.style[e[0]]=e[1].replace(/\_/g," ")},s:"style",hide:function(){this.style.display="none"}},f=function(s){this.version="1.0.2",this.options={developerMode:!1,debugMode:!1,userBang:"!",userBangRegex:/^\!.*$/,userConnector:":",userConnectorRegex:/\:/g,functions:{},angular:!1,removeBangPrefixes:[]};var f={developerMode:t.b,debugMode:t.b,userBang:t.s,userBangRegex:t.o+"&"+t.r,userConnector:t.s,userConnectorRegex:t.o+"&"+t.r,functions:t.o,angular:t.b,removeBangPrefixes:t.o};if(n.settings=typeof s===t.o&&!!s,o().settings){for(var c in s){this.options[c]=s[c]}}for(var d in f){if(-1===f[d].split("&").indexOf(typeof this.options[d])){throw new Error(i("ah",d,typeof this.options[d],f[d]))}}for(var l in this.options.removeBangPrefixes){for(var h in r){if(this.options.removeBangPrefixes[l]===r[h].id){r=r.splice(h,1);break}}}this.events=[];var p=function(e){o().console?console.error("(OneBang) "+e):typeof alert===t.f&&this.options.developerMode&&alert(e),this.events.push(e)}.bind(this),v=function(e){o().console&&this.options.debugMode&&console.info("(OneBang) "+e),this.events.push(e)}.bind(this);e(function(){o().document?o().body||p(i("ab")):p(i("aa"))},this);var b;o().mutation?b=new MutationObserver(function(){this.interpret()}.bind(this)):p(i("ac"));var g=function(e){var t=e.childNodes;for(var n in t){g(t[n])}y(e)}.bind(this),y=function(e){var t=e.attributes;if(t){var n=[];for(var o in t){var i=t[o].name;if(this.options.userBangRegex.test(i)){n.push(i.substr(this.options.userBang.length))}else{for(var s in r){if(r[s].regex.test(i)){n.push(i.substr(r[s].len));break}}}}m(e,n)}}.bind(this),m=function(e,n){for(var o in n){var s=n[o].split(this.options.userConnector),u=s[0];if(s.splice(0,1),""===n[o]){return}for(;typeof this.q[u]===t.s;){u=this.q[u]}if(typeof this.q[u]===t.f){var f=this.options.functions[u];this.q[u]&&this.q[u].bind(e)(s,f||{},this.version,p,v),e.removeAttribute(this.options.userBang+n[o]);for(var c in r){e.removeAttribute(r[c].id+n[o])}}else{a(n[o],this.options.userBang,e),p(i("ad",n[o],u))}}}.bind(this);this.q={};var w=[u],x=function(){for(var e in w){for(var t in w[e]){this.q[t]=w[e][t]}}}.bind(this);x(),this.addplugin=function(e,t){var n={};n[e]=t,w.push(n),x()},this.addplugins=function(e){w.push(e),x()},this.interpret=function(e){return e=e||document.body,g(e),e},e(function(){this.interpret(document.body)},this),typeof b===t.o&&e(function(){b.observe(document.body,{attributes:!0,childList:!0,subtree:!0})},this);var B;this.interval=function(e){o().interval?typeof e!==t.n&&void 0!==B?(clearInterval(B),B=void 0,v("Interval-based updates were stopped.")):typeof e===t.n&&e>0?(B=setInterval(function(){this.interpret(document.body)}.bind(this),e),v("Interval-based updates were started.")):p(i("ae")):p(i("af"))}};if(o().angular){var c=angular.module("oneBang",[]);c.factory("$oneBang",function(){var e=function(e){return e=typeof e===t.o&&e?e:{},e.angular=!0,typeof window.onebang===t.f&&window.onebang(e),window.onebang};return function(t){return e(t)}});var d=function(){return{link:function(e,n){typeof n[0]===t.o&&(n=n[0]),window.onebang.interpret(n)}}},l=["!","bang","::"];for(var h in l){c.directive(l[h],d)}}var p=function(e){window.onebang=new f(e)},v=function(e){return typeof window.onebang===t.f&&p.bind(this)(e),null};if(!o().window){throw new Error("(OneBang) "+i("ag"))}window.onebang=p.bind(this),o().module&&(module.exports=v.bind(this))}();